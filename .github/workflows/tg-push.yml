name: Push Alert

on: [push]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - run: |
          COMMIT_MSG=$(echo '${{ github.event.head_commit.message }}' | head -n1)
          TIMESTAMP=$(date -u +"%Y-%m-%d %H:%M UTC")
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TG_BOT_TOKEN }}/sendMessage" \
          -d chat_id=${{ secrets.TG_CHAT_ID }} \
          -d message_thread_id=$TG_TOPIC_ID \
          -d parse_mode=Markdown \
          -d text=$'ğŸš€ *PUSH DETECTED*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ‘¤ *Developer:* ${{ github.actor }}\nğŸŒ¿ *Branch:* `${{ github.ref_name }}`\nğŸ“¦ *Repo:* `${{ github.repository }}`\nâ° *Time:* '"$TIMESTAMP"$'\n\nğŸ’¬ *Message:*\n_'"$COMMIT_MSG"$'_\n\nğŸ”– *Commit Hash:*\n`${{ github.sha }}`\n\nğŸ”— [View Full Commit](${{ github.event.head_commit.url }})\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâœ¨ Build â†’ Test â†’ Ship ğŸš¢'


env:
  TG_BOT_TOKEN: ${{ secrets.TG_BOT_TOKEN }}
  TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
  TG_TOPIC_ID: ${{ secrets.TG_TOPIC_ID }}
